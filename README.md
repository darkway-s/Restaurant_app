# Restaurant_app
PJ of DS
# 饭店安排桌位系统

> 张驰一 19307130043

为满足顾客们在就餐高峰快速就座的需要，旦苑大饭店邀请你为其开发一款安排桌位的APP。假设饭店有n_1个1人桌位、n_2个2人桌位、…、n_s个s人桌位，每种桌位可接受不多于自身座位数的顾客数量。顾客们按照随机数量组成队，先后进入饭店。不同组的顾客不一起拼桌（比如当前只空余一个四人桌位，有两组分别为三人和一人的顾客在等位，那么这两组顾客不能拼桌同时就餐，而只能让先到来的一组顾客使用四人桌位就餐）。每组顾客就餐结束后这个桌位就立即空余出来，可以安排给其它顾客使用。由于每个桌位在某个时刻只能接待一桌顾客，因此如果当前没有满足顾客数量的空余桌位时，顾客们需要按到来顺序排队，直到有可以容纳自己这组顾客数量的桌位空余出来。

【基本要求】
编写一个程序模拟饭店的安排桌位活动，并计算以下信息：

1. 一天中所有组顾客在饭店的平均停留时间、平均等位时间。注：一组顾客的停留时间=等位时间+就餐时间；
2. 最后一组离开饭店的顾客的离开时间；
3. 将一天内所有组顾客的到达时刻、等位用时、就餐时刻、就餐用时、及离开时刻按格式输出（具体见输出要求），输出按照顾客编号排序。

程序规定有如下设置：
(1) 饭店从11: 00开始营业，顾客到达时间随机产生（如果产生了相同的随机时刻，按照各个组顾客人数从少到多排序号，输入文件中应确保不存在到达时刻和顾客人数均相同的顾客组），一天内到达顾客的组数不少于100组。如果存在顾客离开时刻超出24: 00，计入第二天，最后一组顾客离开的时间不超过（不包括）第二天2: 00；
(2) 每组顾客按到达顺序有独一无二的编号，就餐用时随机产生且不超过半个小时，输出按照顾客到来时刻以及(1)中的规定确定编号排序；
(3) 饭店的桌位信息作为输入进行合理设定；
(4) 不需要提供图形化界面。

【输入输出示例】
输入：
饭店桌位信息从文本文件input_table.txt输入，共有N 行，每行代表一种桌位，每行包括两个数字a和b，表示这种桌位有a张，每张可坐b个人。

顾客信息数据量较大，从文本文件input_customer.txt读入，共有N 行，每行代表一组顾客，包括三个数据：顾客人数、到来时刻、就餐用时。输入不包含顾客编号，到来时刻可能为乱序。程序需按照到来时刻对顾客组进行编号输出。
输出：

计算要求1和2输出到文本文件output_data.txt。
计算要求3：顾客信息按照如下格式输出到文本文件output_customer.txt（可使用tab字符规范格式）：

![image-20201228220334945](image-20201228220334945.png)

## 〇、一些奇思妙想

###### VIP座位：

在基本功能的基础上可以再开发一些特定的桌子，平常不开放，如果进入的是特殊顾客（比如特别需要帮助的人群，比如VIP），就直接进入该桌。

###### 预约：

开放预约功能，在输入中新增预约行为时间，将到来时刻视作预约到来时刻。（这个应该比较好实现，就直接把他们的预约到来时刻当做到来时刻就可以，这里把现场排队和预约的优先度保持一致）

更进一步的推广——不守约行为：预约的人也有到来时刻，如果到来时刻在预约到来时刻之前，而没有人，可以直接就餐（记得取消预约）；如果到来时刻在预约时刻t分钟之后还没来，就视作放弃预约（或者还有个等三桌？）。还可以将这些不守约用户输出出来，列入黑名单（或者累计三次再列）。

###### ABC桌子：

像外婆家那样，对于不同的桌子叫号，四个人只能做四人桌，两个人只能坐两人桌，即使有空的四人桌也不行。推广：k人桌可以承接的顾客组是用户自定义的，默认为k以下的组都可以。比如，饭店只有2人桌和4人桌，老板可以修订为，1人组和2人组去二人桌，3人组和4人组去四人桌，不接待超过四人的桌。

###### 拼桌：

开放拼桌选项。如果A、B两组顾客都接受拼桌，且当前正在就餐的A组桌子足够容纳B组顾客，那么B组可以加入A组所在的桌子（桌子的预计就餐时间更新）

——项目开始之初2020.12.28



# 一、需求分析

> 自顶向下，逐步求精，功能分解

APP的主要功能：安排顾客入座。

增加一个等位层（队列，对于本PJ而言只要把输入的顾客组按照到达时间排序就可），每个新顾客都要先进入等位层。那么就不用管是新顾客还是等了一段时间的顾客，主要功能就成为：安排等位客人入座。



APP中要维护饭店内当前座位安排的状态

该状态能够指示：

1. k人桌位是否可用(0<k<s)
2. 对于k人桌，下一个可用桌出现的时间
3. 今日流水



###### 状态Restaurant

存储着每个桌位table的状态，同时维护着一个今日账单bill

###### 对于每个桌位table，

能够指示：

1. 是否可用

2. 当前用餐人

3. 本次用餐开始时间

4. 本次用餐预计结束时间

###### 还要维护一个等位客人的空间wait_section

存储每个等位客人的状态（到达时间）。该空间能表示

1. 是否有客人在等位

2. 每个等位客人的状态（到达时间）



如果有空出来的桌子，并且有在等位的客人，就要让客人入座。

同时更新对应table，wait_section状态，并把这个行为记录下来（对于bill的更新）

如果有客人吃好了，就要更新桌子的状态



###### 顾客组信息customer_info

储存客人编号id，组里人数size，到达时间arrivetime



输入端：一天中每组顾客的人数，到来时刻，就餐用时

APP功能：安排顾客入座

输出端：一天中每组顾客的到达时间、等位用时、就餐时刻、就餐用时、及离开时刻。（其余项只是对此进行统计分析）



##### 一些需要注意的问题

> 不基本的基本要求

如果存在顾客离开时刻超出24: 00，计入第二天，最后一组顾客离开的时间不超过（不包括）第二天2: 00；

> 12.30 群内提问更新

输出是0:00-2:00和11:00-0:00

针对pj第一题：1.要求123都是针对所有顾客的，不管到来时刻和离开时刻是在24:00前还是后。即：要求1为：计算所有组顾客在饭店的平均停留时间，平均等位时间等信息；要求2为：计算所有组顾客中最后一组的离开时刻（不管是24：00前或者后离开的）；要求3为：将所有组顾客的到达时刻等信息输出
2.基本要求里规定的4条如下设置是自己的输入输出文件和程序本身必须满足的，比如设置1中提到“如果存在顾客离开时刻超出24：00，计入第二天，最后一组顾客离开的时间不超过（不包括）第二天2：00”，这是属于输入数据必须满足的，程序不负责处理2：00后离开的顾客，具体可在输入数据中规避出现这种情况，或者给程序添加错误处理等等办法







## 第一次尝试

先尝试一个只有四个1人桌的小店，进入顾客是两组一人的。

先不管12小时的事情，假设所有事件的发生时间都是在11:00到24:00之间。

> 12.29记
>
> 输入完成





